extends layout

block content
  div
    section.text-center
      img.img_fluid(src="./images/singular-labs.png" alt="singular logo" width="70%" height="70%")
    section.d-flex.justify-content-center
      | SDID
    section.d-flex.justify-content-center
      span.form-text#sdidArea
        | No SDID
    section.d-flex.justify-content-center.mt-1
      | Custom User ID        
    section.d-flex.justify-content-center.mt-1
      input.form-control#customUserIdField(type="text" placeholder="customUserId" aria-label="customUserId")
    section.d-flex.justify-content-center.mt-1
      button.btn.btn-outline-primary#btnLoginEvent
        | Web Login 이벤트
    section.d-flex.justify-content-center.mt-1
      button.btn.btn-outline-primary#btnAddtoCartEvent
        | Web Add to Cart 이벤트
    section.d-flex.justify-content-center.mt-1
      button.btn.btn-outline-primary#btnPurchaseItemEvent
        | Web Purchase 이벤트
    section.d-flex.justify-content-center.mt-1
      button.btn.btn-outline-primary#btnWebToApp
        | 앱으로 이동
    section.d-flex.justify-content-center.mt-1
      button.btn.btn-outline-primary#btnBuildWebToApp
        | Build Web-to-App
    section.d-flex.justify-content-center.mt-1
      input.form-control#webtoappArea(type="url" placeholder="url")
block append-script
  script.
    $(() => {
      console.log('before initSingularSdk');
      initSingularSdk();
      console.log('after initSingularSdk');
      console.log('SDID: ' + singularSdk.getSingularDeviceId());
      $('#sdidArea').text(singularSdk.getSingularDeviceId());
      $('#customUserIdField').val('973157');
      
      // Web Login Event
      $('#btnLoginEvent').on('click', (e) => {
        e.preventDefault();
        const currentCustomUserId = $('#customUserIdField').val();
        console.log('currentCustomUserId: ' + currentCustomUserId);
        if (currentCustomUserId != undefined) {
          singularSdk.setDeviceCustomUserId(currentCustomUserId);
        }  
      });
      // Web Add to cart Event
      $('#btnAddtoCartEvent').on('click', (e) => {
        e.preventDefault();
        sendEvent('Add_to_Cart', {productId: '12345'});
      });
      // Web Purchase Event
      $('#btnPurchaseItemEvent').on('click', (e) => {
        e.preventDefault();
        sendRevenue('Purchase', "KRW", 15000, {productId: '12345'});
      });

      $('#btnWebToApp').on('click', (e) => {
        e.preventDefault();
        openApp();
        e.target.blur();
      });
      $('#btnBuildWebToApp').on('click', (e) => {
        e.preventDefault();
        const link = buildWebToAppLink();
        $('#webtoappArea').val(link);
        e.target.blur();
      });
    });